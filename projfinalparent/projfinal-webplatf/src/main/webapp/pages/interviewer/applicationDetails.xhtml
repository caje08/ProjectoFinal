<?xml version='1.0' encoding='UTF-8' ?>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
      xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">
    <body>
        <ui:composition template="./maininterviewer.xhtml"> 


            <ui:define name="content">

                <h:form> 
                    <h2 >Application details of #{appDetailsStatus.applicant.username}</h2>
                    <h:panelGrid columns="2"  >
                        <h:outputText value="First Name" />
                        <h:outputText value="#{appDetailsStatus.applicant.firstName}" />

                        <h:outputText value="Last Name:" />
                        <h:outputText value="#{appDetailsStatus.applicant.lastName}" />

                        <h:outputText value="Curriculum Vitae" />
                        <p:button href="#{appDetailsStatus.cvPath}" style="color: #{stylesCssToWeb.cssInUse.labelCommandLink}"  target="_blank" value="cv">
                        </p:button>

                        <h:outputText value="Cover Letter" /> 
                       <p:button href="#{appDetailsStatus.coverLetterPath}" style="color: #{stylesCssToWeb.cssInUse.labelCommandLink}"  target="_blank" value="cl">
                        </p:button>

                        <h:outputText value="Email:" />
                        <h:outputText value="#{appDetailsStatus.applicant.email}" />

                        <h:outputText value="Address:" />
                        <h:outputText value="#{appDetailsStatus.applicant.address}" />

                        <h:outputText value="City:" />
                        <h:outputText value="#{appDetailsStatus.applicant.city}" />

                        <h:outputText value="Phone:" />
                        <h:outputText value="#{appDetailsStatus.applicant.phone}" />

                        <h:outputText value="Mobile Phone:" />
                        <h:outputText value="#{appDetailsStatus.applicant.mobile}" />

                        <h:outputText value="Country:" />
                        <h:outputText value="#{appDetailsStatus.applicant.country}" />

                        <h:outputText value="Degree:" />
                        <h:outputText value="#{appDetailsStatus.applicant.degree}" />

                        <h:outputText value="School" />
                        <h:outputText value="#{appDetailsStatus.applicant.school}" />
                        
                         <h:outputText value="Application associated to Position:" />
                        <h:outputText value="#{appDetailsStatus.position.title}" />

                    </h:panelGrid>  



                    <!--Show the Process of interviews of that application-->

                    <p:dataTable  id="questions" var="interview" value="#{appDetailsStatus.lstInterviewsOfInterviewerOfApplication}" 
                                  editable="false" styleClass="borderless"
                                  selectionMode="single" rowKey="#{interview.feedbackId}" selection="#{applicationWebManagem.selectedInterview}" >

                        <f:facet name="header">
                            List of Interviews
                        </f:facet>

                        <p:column  styleClass="centeredColumn"  headerText="Interviewer" style="width:20%">
                            <p:outputLabel value="#{interview.interviewer.username}" />
                        </p:column>

                        <p:column  styleClass="centeredColumn"  headerText="Interview date" style="width:20%" >
                            <h:outputText value="#{interview.interviewDate}" >
                                <f:convertDateTime type="DATE" pattern="dd/MM/yyyy HH:mm"/>
                            </h:outputText>
                        </p:column>

                        <p:column  styleClass="centeredColumn"  headerText="Guide Interview" style="width:20%">
                            <p:outputLabel value="#{interview.interviewEntity.title}" />
                        </p:column>

                        <p:column  styleClass="centeredColumn" headerText="Feedback from Interview" style="width:20%"> 

                            <!--Without Feedback Given-->

                            <p:commandButton rendered="#{!applicationWebManagem.feedbackGiven(interview) and !applicationWebManagem.possibleToSubmitFeedback(interview)}" id="selectInterview" icon="ui-icon-plus"  actionListener="#{applicationWebManagem.appointAnswers(interview)}" oncomplete="PF('feedback1').show()" update=":addfeedbackGuide" >
                                <f:setPropertyActionListener value="#{interview}" target="#{applicationWebManagem.selectedInterview}" />
                            </p:commandButton>

                            <!--With Feedback Given-->

                            <p:commandButton rendered="#{applicationWebManagem.feedbackGiven(interview)}"   id="selectInterview1" icon="ui-icon-search" actionListener="#{applicationWebManagem.appointAnswers(interview)}" oncomplete="PF('feedback').show()" update=":seefeedbackGuide" >
                                <f:setPropertyActionListener value="#{interview}" target="#{applicationWebManagem.selectedInterview}" />
                            </p:commandButton>

                        </p:column>


                    </p:dataTable>

                </h:form>


                <!--Pop up to add feedback--> 

                <h:form id="addfeedbackGuide" >
                    <p:dialog header="Add Feedback" widgetVar="feedback1" modal="true" height="auto" width="auto"  >
                        <h:panelGrid columns="2">
                            <c:forEach items="#{applicationWebManagem.lstAnswers}" var="answer">
                                <h:outputLabel value="#{answer.question}"/>
                                <c:choose>
                                    <c:when test="#{answer.answerType == 'TEXT' }" >
                                        <h:inputTextarea value="#{answer.answer}"/>
                                    </c:when>
                                    <c:when test="#{ answer.answerType == 'INTEGER' }" >
                                        <p:spinner value="#{answer.answer}"
                                                   min="0" max="5" />
                                    </c:when>
                                    <c:when test="#{ answer.answerType == 'BOOLEAN' }" >
                                        <h:selectOneMenu value="#{answer.answer}">
                                            <f:selectItem  itemLabel="True" itemValue="TRUE" />
                                            <f:selectItem  itemLabel="False" itemValue="FALSE" />
                                        </h:selectOneMenu>
                                    </c:when>
                                </c:choose>
                            </c:forEach>
                            <h:outputLabel value="Outcome from this interview:"/>
                            <h:selectOneMenu id="statusapp" value="#{applicationWebManagem.selectedInterview.outcome}">
                                <f:selectItems id="selectionatatus" var="outcome" value="#{applicationWebManagem.lstOutcomes}" itemValue="#{outcome}" itemLabel="#{outcome}"/>
                            </h:selectOneMenu>
                        </h:panelGrid>                      
                        <h:commandButton  value="Add Feedback" action="#{applicationWebManagem.addFeedbak()}" style=" background-color:  ##{stylesCssToWeb.cssInUse.backgroundColorButton};Color: ##{stylesCssToWeb.cssInUse.labelColorButton}" />
                    </p:dialog>
                </h:form>

                <!--Pop up to see feedback given--> 

                <h:form id="seefeedbackGuide" >
                    <p:dialog header="See Feedback" widgetVar="feedback" modal="true" height="auto" width="auto"  >
                        <h:panelGrid columns="2">
                            <c:forEach items="#{applicationWebManagem.lstAnswersWithFeedback}" var="answer">
                                <h:outputLabel value="#{answer.question}"/>
                                <c:choose>
                                    <c:when test="#{answer.answerType == 'TEXT' }" >
                                        <h:inputTextarea value="#{answer.answer}" disabled="true"/>
                                    </c:when>
                                    <c:when test="#{ answer.answerType == 'INTEGER' }" >
                                        <p:spinner  value="#{answer.answer}" disabled="true"
                                                    min="0" max="5" />
                                    </c:when>
                                    <c:when test="#{ answer.answerType == 'BOOLEAN' }" >
                                        <h:selectOneMenu value="#{answer.answer}" disabled="true">
                                            <f:selectItem  itemLabel="True" itemValue="TRUE" />
                                            <f:selectItem  itemLabel="False" itemValue="FALSE" />
                                        </h:selectOneMenu>
                                    </c:when>
                                </c:choose>
                            </c:forEach>
                            <h:outputLabel value="Outcome of this interview"/>
                            <h:outputLabel value="#{applicationWebManagem.selectedInterview.outcome}"/>
                        </h:panelGrid>                      
                    </p:dialog>
                </h:form>


            </ui:define>
        </ui:composition>
    </body>
</html>
