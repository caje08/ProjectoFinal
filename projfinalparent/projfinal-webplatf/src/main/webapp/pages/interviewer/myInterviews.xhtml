
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">
<body>
	<ui:composition template="./maininterviewer.xhtml" style="background-color:  ##{stylesCssToWeb.cssInUse.backgroundInternalWebContentTemplateColor}">

		<ui:define name="content" >
			<h:form id="form">
			   <h1 style="margin-bottom: 20px; font-size: 25px;">Interviews of #{activeSession.activeUser.username}</h1>
				<!-- 				<p:growl id="messages" showDetail="true" /> -->
				<!-- 				<h:panelGroup binding="#{applicationWebManagem.panelInterviews}"> -->
				<!-- 					<h:panelGroup > -->
				<!--List of Interviews of Interviewer -->

				<p:dataTable var="item"
					value="#{applicationWebManagem.lstInterviewsOfInterviewer}"
					paginator="true" rows="10" paginatorPosition="top" editable="false"
					paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
					rowsPerPageTemplate="10,20,30" selectionMode="single"
					rowKey="#{item.feedbackId}"
					selection="#{applicationWebManagem.selectedApplication}">
					<f:facet name="header">
                                List of My Interviews Applications
                            </f:facet>


					<p:column styleClass="centeredColumn"
						filterBy="#{item.application.applicant.username}"
						headerText="Username" filterMatchMode="contains" style="width:20%">
						<a
							href="applicationDetails.xhtml?applicantid=#{item.application.applicant.userId}&amp;applicationid=#{item.application.applicationId}">#{item.application.applicant.username}</a>
					</p:column>


					<p:column styleClass="centeredColumn"
						filterBy="#{item.interviewDate}" filterMatchMode="contains"
						headerText="Interview Date" style="width:20%">
						<p:outputLabel value="#{item.interviewDate}">
							<f:convertDateTime pattern="dd/MM/yyy HH:mm" />
						</p:outputLabel>
					</p:column>

					<p:column styleClass="centeredColumn"
						filterBy="#{item.interviewEntity.type}" filterMatchMode="contains"
						headerText="Interview Type" style="width:20%">
						<p:outputLabel value="#{item.interviewEntity.type}" />
					</p:column>

					<p:column styleClass="centeredColumn"
						filterBy="#{item.interviewEntity.title}"
						filterMatchMode="contains" headerText="Interview Guide Name"
						style="width:20%">
						<p:outputLabel value="#{item.interviewEntity.title}" />
					</p:column>

					<p:column styleClass="centeredColumn"
						headerText="Feedback from Interview" width="auto">

						<!--Without Feedback Given and can be edited because actual date is before scheduled date for more than 1 hour-->

							<p:commandButton
								rendered="#{!applicationWebManagem.feedbackGiven(item) and applicationWebManagem.possibleToSubmitFeedback(item)}"
								id="select2Interview" icon="ui-icon-pencil"
								actionListener="#{applicationWebManagem.appointInterviewers(interview)}"
								oncomplete="PF('editmeeting').show()" update=":editschedule">
								<f:setPropertyActionListener value="#{interview}"
									target="#{applicationWebManagem.selectedInterview}" />
							</p:commandButton>
						
						<!--Without Feedback Given-->

						<p:commandButton styleClass="myButton" ajax="false"
							rendered="#{!applicationWebManagem.feedbackGiven(item) and !applicationWebManagem.possibleToSubmitFeedback(item)}"
							id="selectInterview" icon="ui-icon-plus"
							actionListener="#{applicationWebManagem.appointAnswers(item)}"
							oncomplete="PF('feedback').show()" update=":addfeedbackGuide">
							<f:setPropertyActionListener value="#{item}"
								target="#{applicationWebManagem.selectedInterview}" />
						</p:commandButton>

						<!--With Feedback Given-->

						<p:commandButton styleClass="myButton" ajax="false"
							rendered="#{applicationWebManagem.feedbackGiven(item)}"
							id="selectInterview1" icon="ui-icon-search"
							actionListener="#{applicationWebManagem.appointAnswers(item)}"
							oncomplete="PF('feedback1').show()" update=":seefeedbackGuide">
							<f:setPropertyActionListener value="#{item}"
								target="#{applicationWebManagem.selectedInterview}" />
						</p:commandButton>

					</p:column>

				</p:dataTable>
				<!--Button to add a new Interview-->

					<p:commandButton  styleClass="myButton" ajax="false"
					rendered="#{applicationWebManagem.possibleToAdd}"
						id="selectInterview" value="Add a new interview"
						oncomplete="PF('interviewer').show()" update=":interviewTable">
						<f:setPropertyActionListener value="#{interview}"
							target="#{applicationWebManagem.selectedInterview}" />
					</p:commandButton>
				<!-- 					</h:panelGroup> -->
			</h:form>
			
			<!--Pop up to add feedback-->

			<h:form id="addfeedbackGuide">
				<p:dialog header="Add Feedback" widgetVar="feedback" modal="true"
					height="auto" width="auto">
					<h:panelGrid columns="2">
						<c:forEach items="#{applicationWebManagem.lstAnswers}"
							var="answer">
							<h:outputLabel value="#{answer.question}" />
							<c:choose>
								<c:when test="#{answer.answerType == 'TEXT' }">
									<h:inputTextarea value="#{answer.answer}" />
								</c:when>
								<c:when test="#{ answer.answerType == 'INTEGER' }">
									<p:spinner value="#{answer.answer}" min="0" max="5" />
								</c:when>
								<c:when test="#{ answer.answerType == 'BOOLEAN' }">
									<h:selectOneMenu value="#{answer.answer}">
										<f:selectItem itemLabel="True" itemValue="TRUE" />
										<f:selectItem itemLabel="False" itemValue="FALSE" />
									</h:selectOneMenu>
								</c:when>
							</c:choose>
						</c:forEach>
						<h:outputLabel value="Outcome from this interview:" />
						<h:selectOneMenu id="statusapp"
							value="#{applicationWebManagem.selectedInterview.outcome}">
							<f:selectItems id="selectionatatus" var="outcome"
								value="#{applicationWebManagem.lstOutcomes}"
								itemValue="#{outcome}" itemLabel="#{outcome}" />
						</h:selectOneMenu>
					</h:panelGrid>
					<h:commandButton styleClass="myButton" value="Add Feedback"
						action="#{applicationWebManagem.addFeedback()}"
						style="background-color:  ##{stylesCssToWeb.cssInUse.backgroundColorButton};Color: ##{stylesCssToWeb.cssInUse.labelColorButton}" />
				</p:dialog>
			</h:form>

			<!--Pop up to see feedback given-->

			<h:form id="seefeedbackGuide">
				<p:dialog header="See Feedback" widgetVar="feedback1" modal="true"
					height="auto" width="auto">
					<h:panelGrid columns="2">
						<c:forEach items="#{applicationWebManagem.lstAnswersWithFeedback}"
							var="answer">
							<h:outputLabel value="#{answer.question}" />
							<c:choose>
								<c:when test="#{answer.answerType == 'TEXT' }">
									<h:inputTextarea value="#{answer.answer}" disabled="true" />
								</c:when>
								<c:when test="#{ answer.answerType == 'INTEGER' }">
									<p:spinner value="#{answer.answer}" disabled="true" min="0"
										max="5" />
								</c:when>
								<c:when test="#{ answer.answerType == 'BOOLEAN' }">
									<h:selectOneMenu value="#{answer.answer}" disabled="true">
										<f:selectItem itemLabel="True" itemValue="TRUE" />
										<f:selectItem itemLabel="False" itemValue="FALSE" />
									</h:selectOneMenu>
								</c:when>
							</c:choose>
						</c:forEach>
						<h:outputLabel value="Outcome of this interview" />
						<h:outputLabel
							value="#{applicationWebManagem.selectedInterview.outcome}" />
					</h:panelGrid>
				</p:dialog>
			</h:form>


<!--Pop up to edit a scheduled Interview-->

			<h:form id="editschedule">
				<p:dialog header="Updating a Scheduled Interview"
					widgetVar="editmeeting" modal="true" height="300" width="500">
					<!-- <p:dataTable id="edittheguide" selectionMode="single"
						rowKey="#{interviewer.userId}"
						selection="#{applicationWebManagem.selectedInterviewer}"
						value="#{applicationWebManagem.lstInterviewers}" var="interviewer">

						<p:column styleClass="centeredColumn" headerText="Username"
							filterBy="#{interviewer.username}" filterMatchMode="contains">
                                #{interviewer.username}
                            </p:column>

						<p:column styleClass="centeredColumn" headerText="First Name"
							filterBy="#{interviewer.firstName}" filterMatchMode="contains">
                                #{interviewer.firstName}
                            </p:column>

						<p:column styleClass="centeredColumn" headerText="Last Name"
							filterBy="#{interviewer.lastName}" filterMatchMode="contains">
                                #{interviewer.lastName}
                            </p:column>

					</p:dataTable> -->

					<h:outputText></h:outputText>
					<h:panelGrid columns="2">
						<h3>Interviewer:*</h3>
						<p:outputLabel value="#{applicationWebManagem.selectedInterview.interviewer.username}" />						
						<h3>New Interview Date:*</h3>						
						<p:calendar id="editdatetime"
							value="#{applicationWebManagem.selectedInterview.interviewDate}"
							pattern="MM/dd/yyyy HH:mm" required="true"
							requiredMessage="Must Introduce a Date to this interview" />
					</h:panelGrid>
					<h:commandButton value="Schedule interview"
						action="#{applicationWebManagem.editInterview()}"
						style="background-color:  ##{stylesCssToWeb.cssInUse.backgroundColorButton};Color: ##{stylesCssToWeb.cssInUse.labelColorButton}" />

				</p:dialog>
			</h:form>

		 	<!--Pop up to add a new Interview-->
<!--
			<h:form id="interviewTable">
				<p:dialog header="Add a new Interview" widgetVar="interviewer"
					modal="true" height="300" width="500">
					<p:dataTable id="theguide" selectionMode="single"
						rowKey="#{interviewer.userId}"
						selection="#{applicationWebManagem.selectedInterviewer}"
						value="#{manageApplicationWeb.collectListOfInterviewers()}" var="interviewer">
						value="#{applicationWebManagem.lstInterviewers}" var="interviewer">

						<p:column styleClass="centeredColumn" headerText="Username"
							filterBy="#{interviewer.username}" filterMatchMode="contains">
                                #{interviewer.username}
                            </p:column>

						<p:column styleClass="centeredColumn" headerText="First Name"
							filterBy="#{interviewer.firstName}" filterMatchMode="contains">
                                #{interviewer.firstName}
                            </p:column>

						<p:column styleClass="centeredColumn" headerText="Last Name"
							filterBy="#{interviewer.lastName}" filterMatchMode="contains">
                                #{interviewer.lastName}
                            </p:column>

					</p:dataTable>
					<h:outputText></h:outputText>
					<h:panelGrid columns="2">
						<h3>Interview Date:*</h3>
						<p:calendar id="datetime"
							value="#{applicationWebManagem.interviewDate}"
							pattern="MM/dd/yyyy HH:mm" required="true"
							requiredMessage="Must Introduce a Date for this interview" />
					</h:panelGrid>
					<h:commandButton value="Schedule interview"
						action="#{applicationWebManagem.createNewInterview()}"
						style="background-color:  ##{stylesCssToWeb.cssInUse.backgroundColorButton};Color: ##{stylesCssToWeb.cssInUse.labelColorButton}" />

				</p:dialog>
			</h:form>

			Pop up to edit a scheduled Interview

			<h:form id="editschedule">
				<p:dialog header="Updating a Scheduled Interview"
					widgetVar="editmeeting" modal="true" height="300" width="500">
					<p:dataTable id="edittheguide" selectionMode="single"
						rowKey="#{interviewer.userId}"
						selection="#{applicationWebManagem.selectedInterviewer}"
						value="#{applicationWebManagem.lstInterviewers}" var="interviewer">

						<p:column styleClass="centeredColumn" headerText="Username"
							filterBy="#{interviewer.username}" filterMatchMode="contains">
                                #{interviewer.username}
                            </p:column>

						<p:column styleClass="centeredColumn" headerText="First Name"
							filterBy="#{interviewer.firstName}" filterMatchMode="contains">
                                #{interviewer.firstName}
                            </p:column>

						<p:column styleClass="centeredColumn" headerText="Last Name"
							filterBy="#{interviewer.lastName}" filterMatchMode="contains">
                                #{interviewer.lastName}
                            </p:column>

					</p:dataTable>

					<h:outputText></h:outputText>
					<h:panelGrid columns="2">
						<h3>Interviewer:*</h3>
						<p:outputLabel value="#{applicationWebManagem.selectedInterview.interviewer.username}" />						
						<h3>New Interview Date:*</h3>						
						<p:calendar id="editdatetime"
							value="#{applicationWebManagem.selectedInterview.interviewDate}"
							pattern="MM/dd/yyyy HH:mm" required="true"
							requiredMessage="Must Introduce a Date to this interview" />
					</h:panelGrid>
					<h:commandButton value="Schedule interview"
						action="#{applicationWebManagem.editInterview()}"
						style="background-color:  ##{stylesCssToWeb.cssInUse.backgroundColorButton};Color: ##{stylesCssToWeb.cssInUse.labelColorButton}" />

				</p:dialog>
			</h:form>
			 -->

		</ui:define>
	</ui:composition>
</body>
</html>
